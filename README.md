# Python Concurrency Examples

This repository contains examples of how to use Python's built-in concurrency features such as multi-threading, and multi-processing. Each example is a self-contained script that demonstrates a specific use case where we test out the performance of multi-threading and multi-processing. Tracing is done via [VizTracer](https://viztracer.readthedocs.io/en/latest/basic_usage.html) and visualized using VizViewer.

## Dependencies

- Python 3.12+
- VizTracer
- VizViewer
- Requests

After setting up a Python 3.12 virtual environment, you can install the dependencies using the following command:

```bash
pip install -r requirements.txt
```

## Examples

- [Caclulating Prime Numbers](./src/calc_primes)
- [Calling HTTP Endpoints](./src/http_extraction)


## Running the Examples

To run the examples, you can simply execute the Python via Viztracer script using the following command:


```bash
python -m viztracer src/calc_primes/main.py --limit=[ELEMENTS] --mode=[MODE]
```
Limit (optional) is the number of elements to calculate the prime numbers up to. Mode (optional) is the concurrency mode to use (threading or multiprocessing).

mode can be either `threading` or `multiprocessing`. For example, to run the HTTP extraction example with multiprocessing, you can run the following command:

```bash
python -m viztracer src/http_extraction/main.py --mode=multiprocessing
```

By default if no mode is specified, the script will run in sequential mode.


## Visualizing the Traces

After running the examples, you can visualize the traces using VizViewer. To do this, you can run the following command:

```bash
vizviewer [TRACE_FILE].json
```

Where `TRACE_FILE` is the path to the trace file generated by VizTracer. By default on this project, the trace files are stored in the `profiler_output` directory.

For example, to visualize the trace file generated by the HTTP extraction example, you can run the following command:

```bash
vizviewer profile_output/report.json
```
